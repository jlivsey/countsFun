% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/AllFunctions.R
\name{ParticleFilter}
\alias{ParticleFilter}
\title{Particle Filter Latent Gaussian Count Models}
\usage{
ParticleFilter(theta, mod)
}
\arguments{
\item{theta}{Numeric vector. Current parameter estimates including marginal, AR, and MA parameters.}

\item{mod}{List. Model specification object containing all necessary elements for filtering, such as:
\describe{
\item{\code{DependentVar}}{Numeric vector of observed counts.}
\item{\code{CountDist}}{Character string specifying the count distribution (e.g., \code{"Poisson"}, \code{"Binomial"}).}
\item{\code{ARMAModel}}{Numeric vector \code{c(p, q)} specifying AR and MA orders.}
\item{\code{ParticleNumber}}{Integer. Number of particles used in the filter.}
\item{\code{n}}{Integer. Length of the observed time series.}
\item{\code{mycdf}}{User-supplied function returning the marginal CDF of the count distribution.}
\item{\code{mypdf}}{User-supplied function returning the marginal PDF of the count distribution.}
\item{\code{Regressor}}{Optional numeric vector or matrix of regressors.}
\item{\code{nreg}}{Integer. Number of regressors.}
\item{\code{verbose}}{Logical. If \code{TRUE}, prints diagnostic messages during filtering.}
\item{\code{maxdiff}}{Numeric tolerance used in the Innovations Algorithm convergence criterion.}
}}
}
\value{
Returns the numeric value of the negative log-likelihood (\eqn{-\ell(\theta)}).
If numerical issues occur (e.g., unstable ARMA coefficients, degenerate weights, or non-finite log-likelihood),
the function returns a large penalty value (\eqn{10^8}) to guide optimization away from invalid parameter regions.
}
\description{
Implements a particle filtering algorithm for latent Gaussian count time series models
with potentially misspecified ARMA dependence structures.
The algorithm sequentially updates latent Gaussian states, particle weights, and the log-likelihood,
using the Innovations Algorithm to obtain one-step-ahead predictors and innovation variances.
Corrections are applied to truncated normal sampling limits and particle weights
when numerical instability or boundary issues occur.
}
\details{
The function evaluates the (negative) log-likelihood for an LGC model under ARMA dynamics.
}
